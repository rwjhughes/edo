(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{9442:function(e,n,t){"use strict";t.r(n);var r=t(1626),a=t(8216),i=t(5997),o=t(2809),s=t(7618),u=t(5893),c=(t(4877),t(7294)),l=t(5851);function d(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw i}}}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var p=["Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],g={attack:{label:"attack (s)",mapping:function(e){return(10*Math.exp(.0206*e)-10)/6.342},round:!1,device:"synth",assign:function(e,n){e.envelope.attack=n,e.modulationEnvelope.attack=n}},release:{label:"release (s)",mapping:function(e){return(10*Math.exp(.0206*e)-10)/3.9635},round:!1,device:"synth",assign:function(e,n){e.envelope.release=n,e.modulationEnvelope.release=n}},modulation:{label:"modulation",mapping:function(e){return 7.884*(10*Math.exp(.0206*e)-10)},round:!0,device:"synth",assign:function(e,n){return e.modulationIndex.value=n}},reverb:{label:"reverb",mapping:function(e){return e/127},round:!1,device:"reverb",assign:function(e,n){return e.wet.value=n}},feedback:{label:"feedback",mapping:function(e){return e/158},round:!1,device:"delay",assign:function(e,n){e.feedback.value=n}},time:{label:"time (s)",mapping:function(e){return(10*Math.exp(.0206*e)-10)/12.68},round:!1,device:"delay",assign:function(e,n){return e.delayTime.value=n}},lowpass:{label:"lowpass (Hz)",mapping:function(e){return 157.32*(Math.exp(.038205*e)-1)+20},round:!0,device:"lowpass",assign:function(e,n){return e.frequency.value=n}},gain:{label:"gain",mapping:function(e){return e/127},round:!1,device:"gain",assign:function(e,n){return e.gain.value=n}}},m=function(e){var n=e.label,t=e.displayValue,r=e.input,a=e.setInput,i=e.midiInput,o=e.changeParameter;return(0,u.jsxs)("div",{className:"effect",children:[(0,u.jsx)("p",{class:"effectinfo",children:n}),(0,u.jsx)("div",{class:"effectlogo"}),(0,u.jsx)("span",{children:t}),(0,u.jsx)("button",{className:"midimap",onClick:o,children:i?"set"===i?"map":"".concat(i):"map"}),(0,u.jsx)("input",{type:"range",min:"0",max:"127",value:r,className:"slider",onChange:function(e){return a(Number(e.target.value))}})]})};n.default=function(){var e="ontouchstart"in window,n=(0,c.useRef)(null),t=(0,c.useState)(500*Math.random()),r=t[0],a=t[1],i=(0,c.useState)(Math.round(23*Math.random()+1)),d=i[0],f=i[1],h=(0,c.useState)(null),b=h[0],x=h[1],j=(0,c.useState)({attack:60*Math.random(),release:127*Math.random(),modulation:60*Math.random(),reverb:127*Math.random(),feedback:127*Math.random(),time:127*Math.random(),lowpass:120*Math.random()+7,gain:101}),w=j[0],k=j[1],M=(0,c.useState)(),N=M[0],S=M[1],D=(0,c.useState)([{},{}]),O=D[0],K=D[1],E=(0,c.useState)(),I=E[0],_=E[1],A=isNaN(r)||isNaN(d)||d<1||d>24||r<1,P=[],C=2*d;if(!A)for(var q=0,T=(0,s.Z)(Array(C).keys());q<T.length;q++){var R=T[q];0===R?P.push(r):P.push(Math.pow(2,1/d)*P[R-1])}var Z,z=function(e){var n=e.input,t=e.value;if(N){var r=v(v({},O[0]),{},(0,o.Z)({},N,n)),a=Object.keys(r).reduce((function(e,n){return v(v({},e),{},(0,o.Z)({},r[n],e[r[n]]?e[r[n]].concat([n]):[n]))}),{}),i=[r,a];K(i),S(void 0),localStorage.midiMap=JSON.stringify(i)}else{var s=O[1][n];if(s){var u=v({},w);s.forEach((function(e){return u[e]=t})),k(u)}}};return(0,c.useEffect)((function(){if(n.current){console.log("setting message callback");var e=z;window.onDeviceInput=e,n.current.onDeviceInput=e}}),[N,w,O]),(0,c.useEffect)((function(){if(b||x(function(){var e=new l.S9(.8),n=new l.S9(.8),t=new l.E8({wet:.6,decay:30}),r=new l.D0({time:.1,feedback:.7,wet:.5}),a=new l.wn(2e3,"lowpass");return e.connect(t),t.connect(r),r.connect(a),a.connect(n),n.toDestination(),{synth:new l.tC({oscillator:{type:"sine"},modulationIndex:10,modulation:{type:"sawtooth"},modulationEnvelope:{attack:5,release:9},envelope:{attack:3,decay:3,sustain:.8,release:8,attackCurve:"sine"}}).connect(e),lowpass:a,delay:r,reverb:t,gain:n}}()),!n.current){var e=new y;e.start().then((function(){console.log("Started!")})).catch(console.error),n.current=e}if(localStorage.midiMap){var t=JSON.parse(localStorage.midiMap);K(t)}navigator&&navigator.keyboard&&navigator.keyboard.getLayoutMap().then((function(e){_(e)}))}),[]),(0,c.useEffect)((function(){var e=function(e){console.log(e.code);var n=p.indexOf(e.code);-1!==n&&n<P.length&&b.synth.triggerAttack(P[n])},n=function(e){return b.synth.triggerRelease()};return document.addEventListener("keydown",e),document.addEventListener("keyup",n),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",n)}}),[P,b]),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("title",{children:"EDO SYNTH"}),(0,u.jsx)("h1",{children:"EDO SYNTH [beta]"}),(0,u.jsx)("h2",{children:(0,u.jsx)("a",{href:"https://richardhughes.ie",target:"_blank",title:"Get me out of here!",children:"Richard Hughes"})})]}),(0,u.jsx)("ul",{children:(0,u.jsx)("li",{children:"Generate a microtonal synth by entering in the starting frequency and the amount of ocatve divisions."})}),(0,u.jsxs)("ul",{id:"acknowledge",children:["Thanks to ",(0,u.jsx)("a",{href:"https://rory.ie",target:"_blank",children:"Rory Hughes"})," for help with coding",(0,u.jsx)("br",{})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("form",{name:"edo-cal",children:[(0,u.jsxs)("span",{className:"tooltiptext",children:[(0,u.jsx)("i",{children:" f"}),(0,u.jsx)("sub",{children:"0"})," (Hz)"]}),(0,u.jsx)("input",{name:"f0",id:"f0",type:"text",placeholder:"e.g 110",size:"10",required:!0,className:"fundamental",value:r.toFixed(2),onChange:function(e){return a(Number(e.target.value))}}),(0,u.jsx)("input",{type:"range",min:"6000",max:"20000",value:(Z=r,Math.log(Z)/495175e-9),className:"sideslider1 tooltip",onChange:function(e){return a(function(e){return Math.exp(495175e-9*e)}(Number(e.target.value)))}}),(0,u.jsx)("span",{className:"tooltiptext",children:"divisions"}),(0,u.jsx)("input",{name:"divisions",type:"text",placeholder:"max: 24",size:"10",required:!0,className:"divisions",value:d,onChange:function(e){return f(Number(e.target.value))}}),(0,u.jsx)("input",{type:"range",min:"1",max:"24",value:d,className:"sideslider2 tooltip",onChange:function(e){return f(Number(e.target.value))}}),A&&(0,u.jsx)("p",{id:"invalid",children:"enter a valid number in both boxes"})]}),(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"field",children:[(0,u.jsx)("span",{children:"oscillator"}),(0,u.jsxs)("select",{id:"oscillator-type",onChange:function(e){return b.synth.oscillator.type=e.target.value},children:[(0,u.jsx)("option",{value:"sine",children:"sine"}),(0,u.jsx)("option",{value:"triangle",children:"triangle"}),(0,u.jsx)("option",{value:"sawtooth",children:"sawtooth"}),(0,u.jsx)("option",{value:"square",children:"square"})]})]}),(0,u.jsxs)("div",{className:"lowersliders",children:[Object.keys(g).map((function(e){var n=g[e],t=n.label,r=n.mapping,a=n.round,i=n.device,s=n.assign,c=w[e],l=r(c);b&&s(b[i],l);var d=a?Math.round(l):l.toFixed(2);return(0,u.jsx)(m,{label:t,displayValue:d,input:c,setInput:function(n){k(v(v({},w),{},(0,o.Z)({},e,n)))},midiInput:N&&N===e?"set":O[0][e],changeParameter:function(){return S(e)}},e)})),(0,u.jsx)("br",{}),(0,u.jsx)("button",{onClick:function(){K([{},{}]),localStorage.removeItem("midiMap")},className:"clear",children:"clear midi map"})]})]}),(0,u.jsx)("div",{id:"container",children:I&&P.map((function(n,t){return(0,u.jsx)("div",{className:"note",onMouseDown:e?void 0:function(){return b.synth.triggerAttack(n)},onTouchStart:e?function(){return b.synth.triggerAttack(n)}:void 0,onMouseUp:e?void 0:function(){return b.synth.triggerRelease()},onTouchEnd:e?function(){return b.synth.triggerAttack()}:void 0,onMouseLeave:e?void 0:function(){return b.synth.triggerRelease()},children:(0,u.jsx)("span",{children:I.get(p[t])})},n)}))}),(0,u.jsx)("footer",{children:"\xa9 Richard Hughes 2021"})]})};var y=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.Z)(this,e),this.onDeviceInput=n.onDeviceInput||console.log}return(0,i.Z)(e,[{key:"start",value:function(){var e=this;return new Promise((function(n,t){e._requestAccess().then((function(t){e.initalize(t),n()})).catch((function(){return t("Something went wrong.")}))}))}},{key:"initalize",value:function(e){var n,t=d(e.inputs.values());try{for(t.s();!(n=t.n()).done;){var r=n.value;this.initalizeDevice(r)}}catch(a){t.e(a)}finally{t.f()}}},{key:"initalizeDevice",value:function(e){e.onmidimessage=this.onMessage.bind(this)}},{key:"onMessage",value:function(e){var n=(0,r.Z)(e.data,3),t=(n[0],n[1]),a=n[2];this.onDeviceInput({input:t,value:a})}},{key:"_requestAccess",value:function(){return new Promise((function(e,n){navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(e).catch(n):n()}))}}]),e}()},3002:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edo_adapted",function(){return t(9442)}])}},function(e){e.O(0,[645,774,888,179],(function(){return n=3002,e(e.s=n);var n}));var n=e.O();_N_E=n}]);