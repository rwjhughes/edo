(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5956:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(1626),i=t(8216),a=t(5997),o=t(5893),s=t(2809),c=t(809),l=t.n(c);function u(e,n,t,r,i,a,o){try{var s=e[a](o),c=s.value}catch(l){return void t(l)}s.done?n(c):Promise.resolve(c).then(r,i)}function d(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)}))}}var h=t(7618),f=t(4877),p=t(7294),m=t(5851);function v(e,n){var t;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(s)throw a}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var b=["Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],j={attack:{label:"attack (s)",definition:"attack is the time taken for the note to fade in.",mapping:function(e){return(10*Math.exp(.0206*e)-10)/6.342},round:!1,device:"synth",assign:function(e,n){e.envelope.attack=n,e.modulationEnvelope.attack=n}},release:{label:"release (s)",definition:"release is the time taken for the note to fade out.",mapping:function(e){return(10*Math.exp(.0206*e)-10)/3.9635},round:!1,device:"synth",assign:function(e,n){e.envelope.release=n,e.modulationEnvelope.release=n}},modulation:{label:"modulation",definition:"modulation creates a noisier and distorted timbre.",mapping:function(e){return 7.884*(10*Math.exp(.0206*e)-10)},round:!0,device:"synth",assign:function(e,n){return e.modulationIndex.value=n}},reverb:{label:"reverb",definition:"reverb is the effect of having reflections of the sound, it adds a sense of space and depth.",mapping:function(e){return e/127},round:!1,device:"reverb",assign:function(e,n){return e.wet.value=n}},feedback:{label:"feedback",definition:"feedback is one of two delay effects. The more feedback the louder and long lasting the delay will sound.",mapping:function(e){return e/158},round:!1,device:"delay",assign:function(e,n){e.feedback.value=n}},time:{label:"time (s)",definition:"time is one of two delay effects. The sound is replayed after the time chosen.",mapping:function(e){return(10*Math.exp(.0206*e)-10)/12.68},round:!1,device:"delay",assign:function(e,n){return e.delayTime.value=n}},lowpass:{label:"lowpass (Hz)",definition:"lowpass filter cuts out the high frequencies. The frequencies above the value set are cut off.",mapping:function(e){return 157.32*(Math.exp(.038205*e)-1)+20},round:!0,device:"lowpass",assign:function(e,n){return e.frequency.value=n}},gain:{label:"gain",definition:"gain is the volume.",mapping:function(e){return e/127},round:!1,device:"gain",assign:function(e,n){return e.gain.value=n}}},w=function(e){var n=e.label,t=e.definition,r=e.displayValue,i=e.input,a=e.setInput,s=e.midiInput,c=e.changeParameter;return(0,o.jsxs)(f.X2,{p:"10px 0",children:[(0,o.jsxs)(f.gq,{alignItems:"baseline",children:[(0,o.jsx)(f.zh,{children:(0,o.jsxs)("span",{className:"tooltip",children:[n,(0,o.jsx)("span",{className:"tooltiptext",children:t})]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{children:r}),(0,o.jsx)("button",{className:"midimap",onClick:c,children:s?"set"===s?"map":"".concat(s):"map"})]})]}),(0,o.jsx)(f.iR,{type:"range",min:"0",max:"127",value:i,onChange:function(e){return a(Number(e.target.value))}})]})},k=function(){var e="ontouchstart"in window,n=(0,p.useRef)(null),t=(0,p.useState)(500*Math.random()),r=t[0],i=t[1],a=(0,p.useState)(Math.round(23*Math.random()+1)),c=a[0],u=a[1],v=(0,p.useState)(),g=v[0],y=v[1],k=(0,p.useState)(null),S=k[0],D=k[1],M=(0,p.useState)({attack:60*Math.random(),release:127*Math.random(),modulation:60*Math.random(),reverb:127*Math.random(),feedback:127*Math.random(),time:127*Math.random(),lowpass:120*Math.random()+7,gain:101}),O=M[0],E=M[1],I=(0,p.useState)(),K=I[0],T=I[1],q=(0,p.useState)([{},{}]),C=q[0],P=q[1],A=(0,p.useState)(),R=A[0],_=A[1],H=(0,p.useState)(),Z=H[0],L=H[1],z=isNaN(r)||isNaN(c)||c<1||c>24||r<1,Y=[],F=2*c;if(!z)for(var X=0,J=(0,h.Z)(Array(F).keys());X<J.length;X++){var U=J[X];0===U?Y.push(r):Y.push(Math.pow(2,1/c)*Y[U-1])}var B,V=function(){var e=d(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("record"),y(null),S.recorder.start();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=d(l().mark((function e(){var n,t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("stop"),e.next=3,S.recorder.stop();case 3:n=e.sent,t=URL.createObjectURL(n),y(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(e){var n=e.input,t=e.value;if(K){var r=x(x({},C[0]),{},(0,s.Z)({},K,n)),i=Object.keys(r).reduce((function(e,n){return x(x({},e),{},(0,s.Z)({},r[n],e[r[n]]?e[r[n]].concat([n]):[n]))}),{}),a=[r,i];P(a),T(void 0),localStorage.midiMap=JSON.stringify(a)}else{var o=C[1][n];if(o){var c=x({},O);o.forEach((function(e){return c[e]=t})),E(c)}}};return(0,p.useEffect)((function(){if(n.current){console.log("setting message callback");var e=Q;window.onDeviceInput=e,n.current.onDeviceInput=e}}),[K,O,C]),(0,p.useEffect)((function(){if(S||D(function(){var e=new m.KN({mimeType:"audio/webm; codecs=opus"}),n=new m.S9(.8),t=new m.S9(.8),r=new m.E8({wet:.6,decay:30}),i=new m.D0({time:.1,feedback:.7,wet:.5}),a=new m.wn(2e3,"lowpass");return n.connect(r),r.connect(i),i.connect(a),a.connect(t),t.toDestination(),t.connect(e),{synth:new m.tC({oscillator:{type:"sine"},modulationIndex:10,modulation:{type:"sawtooth"},modulationEnvelope:{attack:5,release:9},envelope:{attack:3,decay:3,sustain:.8,release:8,attackCurve:"sine"}}).connect(n),lowpass:a,delay:i,reverb:r,gain:t,recorder:e}}()),!n.current){var e=new N;e.start().then((function(){console.log("Started!")})).catch(console.error),n.current=e}if(localStorage.midiMap){var t=JSON.parse(localStorage.midiMap);P(t)}navigator&&navigator.keyboard&&navigator.keyboard.getLayoutMap().then((function(e){_(e)}))}),[]),(0,p.useEffect)((function(){var e=function(e){console.log(e.code);var n=b.indexOf(e.code);-1!==n&&n<Y.length&&(S.synth.triggerAttack(Y[n]),L(n))},n=function(e){S.synth.triggerRelease(),L(void 0)};return document.addEventListener("keydown",e),document.addEventListener("keyup",n),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",n)}}),[Y,S]),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"deeper",children:[(0,o.jsx)("title",{children:"EDO SYNTH - Richard Hughes"}),(0,o.jsx)("h1",{children:"EDO SYNTH"}),(0,o.jsx)("h2",{children:(0,o.jsx)("a",{href:"https://richardhughes.ie",target:"_blank",title:"Get me out of here!",children:"Richard Hughes"})})]}),(0,o.jsxs)(f.gq,{children:[(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:["Welcome to ",(0,o.jsx)("b",{children:"EDO SYNTH"}),", an interactive microtonal synthesiser which lets you create your own tuning systems and sounds. Here's an overview of how it works."]}),(0,o.jsxs)("li",{children:["Two sliders determine the pitches of the synth. ",(0,o.jsxs)("b",{children:[(0,o.jsx)("i",{children:" f"}),(0,o.jsx)("sub",{children:"0"})]})," is where the scale starts and ",(0,o.jsx)("b",{children:"divisions"})," changes how much the octave is divided into equal parts, hence equal divisions of the octave - EDO."]}),(0,o.jsx)("li",{children:"The computer keyboard can be used to play the notes. For mobile users, the keypads can be tapped or held."}),(0,o.jsx)("li",{children:"EDO SYNTH is a monotonal synthesiser, meaning only one note can be played at a time."}),(0,o.jsx)("li",{children:"Two octaves of your microtonal scale are generated."})]}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:["It is possible to record yourself playing and download it. Just click the ",(0,o.jsx)("b",{children:(0,o.jsx)("red",{children:"record"})})," button to begin and ",(0,o.jsx)("b",{children:"stop"})," to end the recording."]}),(0,o.jsxs)("li",{children:["The drop down menu lets you choose an ",(0,o.jsx)("b",{children:"oscillator"}),", or waveform. It determines the fundamental timbre of the synthesiser."]}),(0,o.jsxs)("li",{children:["The 8 sliders are the audio effects. They each have a definition when you hover over them. You can click and drag the sliders or you can also ",(0,o.jsx)("b",{children:"MIDI map"})," them to a device. Just click the ",(0,o.jsx)("b",{children:"map"})," button then move the knob or slider on your device you wish to be mapped. The MIDI mapping is remembered when you return, you can also remap or clear it. Make sure your MIDI device is plugged in before you load the page."]})]})]}),(0,o.jsx)(f.gq,{justify:"center",children:(0,o.jsxs)("ul",{id:"acknowledge",children:["Thanks to ",(0,o.jsx)("b",{children:(0,o.jsx)("a",{href:"https://twitter.com/rorhug",target:"_blank",children:"Rory Hughes"})})," for help with coding.",(0,o.jsx)("br",{}),"And to the Screen Dive team for helping to realise this project.",(0,o.jsx)("br",{})]})}),(0,o.jsxs)("p",{children:[(0,o.jsx)("br",{}),(0,o.jsx)("button",{id:"record",onClick:V,disabled:!S||"started"===S.recorder.state}),(0,o.jsx)("button",{id:"stopRecord",disabled:!S||"stopped"===S.recorder.state,onClick:G,children:"stop"}),g&&(0,o.jsx)("a",{id:"downloadButton",href:g,download:"EDO SYNTH - "+(new Date).toLocaleString()+".ogg",children:"download"})]}),g&&(0,o.jsx)("p",{children:(0,o.jsx)(f.zF,{controls:!0,children:(0,o.jsx)("source",{src:g,type:"audio/webm"})})}),(0,o.jsxs)(f.Z0,{p:"20px 0",justify:"space-between",children:[(0,o.jsxs)(f.X2,{children:[(0,o.jsxs)("div",{className:"tooltip slider-header",children:[(0,o.jsxs)("span",{className:"header",children:[(0,o.jsx)("i",{children:" f"}),(0,o.jsx)("sub",{children:"0"})," (Hz)"]}),(0,o.jsxs)("span",{className:"tooltiptext",children:[(0,o.jsx)("i",{children:"f"}),(0,o.jsx)("sub",{children:"0"})," is the lowest note of the scale."]})]}),(0,o.jsx)("input",{name:"f0",id:"f0",type:"text",placeholder:"e.g 110",size:"10",required:!0,className:"fundamental",value:r.toFixed(2),onChange:function(e){return i(Number(e.target.value))}}),(0,o.jsx)(f.iR,{big:!0,type:"range",min:"6050",max:"20000",value:(B=r,Math.log(B)/.00049517438),onChange:function(e){return i(function(e){return Math.exp(.00049517438*e)}(Number(e.target.value)))}})]}),(0,o.jsxs)(f.X2,{children:[(0,o.jsxs)("div",{className:"tooltip",children:[(0,o.jsx)("span",{className:"header",children:"divisions"}),(0,o.jsx)("span",{className:"tooltiptext",children:"divisions is how many times the octave will be divided equally."})]}),(0,o.jsx)("input",{name:"divisions",type:"text",placeholder:"max: 24",size:"10",required:!0,className:"fundamental",value:c,onChange:function(e){return u(Number(e.target.value))}}),(0,o.jsx)(f.iR,{big:!0,type:"range",min:"1",max:"24",value:c,className:"slider1",onChange:function(e){return u(Number(e.target.value))}})]}),z&&(0,o.jsx)("p",{id:"invalid",children:"enter a valid number in both boxes"})]}),(0,o.jsx)(f.gq,{justify:"center",children:(0,o.jsx)(f.Z0,{p:"20px 0",mw:"990px",children:R&&Y.map((function(n,t){return(0,o.jsxs)(p.Fragment,{children:[(0,o.jsx)(f.jC,{className:Z===t&&"current",onMouseDown:e?void 0:function(){return S.synth.triggerAttack(n)},onTouchStart:e?function(){return S.synth.triggerAttack(n)}:void 0,onMouseUp:e?void 0:function(){return S.synth.triggerRelease()},onTouchEnd:e?function(){return S.synth.triggerAttack()}:void 0,onMouseLeave:e?void 0:function(){return S.synth.triggerRelease()},children:(0,o.jsx)("span",{children:R.get(b[t])})}),0===(t<24?(t+1)%12:t<44?(t-1)%11:t%44)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.aw,{}),(0,o.jsx)(f.YS,{w:"".concat(t/10*30,"px")})]})]},n)}))})}),(0,o.jsxs)("div",{className:"field",children:[(0,o.jsxs)("div",{className:"tooltip",children:[(0,o.jsx)("span",{children:"oscillator"}),(0,o.jsx)("span",{className:"tooltiptext",children:"oscillator is the type of waveform which have distinct timbres."})]}),(0,o.jsxs)("select",{id:"oscillator-type",onChange:function(e){return S.synth.oscillator.type=e.target.value},children:[(0,o.jsx)("option",{value:"sine",children:"sine"}),(0,o.jsx)("option",{value:"triangle",children:"triangle"}),(0,o.jsx)("option",{value:"sawtooth",children:"sawtooth"}),(0,o.jsx)("option",{value:"square",children:"square"})]}),(0,o.jsx)("button",{onClick:function(){P([{},{}]),localStorage.removeItem("midiMap")},className:"clear midimap",children:"clear midi map"})]}),(0,o.jsx)(f.Z0,{justify:"space-between",children:Object.keys(j).map((function(e){var n=j[e],t=n.label,r=n.definition,i=n.mapping,a=n.round,c=n.device,l=n.assign,u=O[e],d=i(u);S&&l(S[c],d);var h=a?Math.round(d):d.toFixed(2);return(0,o.jsx)(w,{label:t,definition:r,displayValue:h,input:u,setInput:function(n){E(x(x({},O),{},(0,s.Z)({},e,n)))},midiInput:K&&K===e?"set":C[0][e],changeParameter:function(){return T(e)}},e)}))}),(0,o.jsx)("br",{}),(0,o.jsx)("footer",{children:"\xa9 Richard Hughes 2021"})]})},N=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),this.onDeviceInput=n.onDeviceInput||console.log}return(0,a.Z)(e,[{key:"start",value:function(){var e=this;return new Promise((function(n,t){e._requestAccess().then((function(t){e.initalize(t),n()})).catch((function(){return t("Something went wrong.")}))}))}},{key:"initalize",value:function(e){var n,t=v(e.inputs.values());try{for(t.s();!(n=t.n()).done;){var r=n.value;this.initalizeDevice(r)}}catch(i){t.e(i)}finally{t.f()}}},{key:"initalizeDevice",value:function(e){e.onmidimessage=this.onMessage.bind(this)}},{key:"onMessage",value:function(e){var n=(0,r.Z)(e.data,3),t=(n[0],n[1]),i=n[2];this.onDeviceInput({input:t,value:i})}},{key:"_requestAccess",value:function(){return new Promise((function(e,n){navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(e).catch(n):n()}))}}]),e}()},8581:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5956)}])}},function(e){e.O(0,[645,774,888,179],(function(){return n=8581,e(e.s=n);var n}));var n=e.O();_N_E=n}]);